# MLOps Demo

A simple machine learning pipeline demo project.

<br/>

## Project Structure

```
mlops-demo/
├── data/
│   └── user_activity.csv       # Original CSV data
│   └── X.csv / y.csv          # Preprocessed input/target
│   └── scaler.pkl             # StandardScaler object for data scaling
├── model/
│   └── model.pkl              # Trained RandomForestClassifier model
├── preprocess.py              # Preprocessing script
├── train_model.py             # Training and saving script
├── predict_api.py             # FastAPI-based inference server
├── requirements.txt           # Dependencies
└── Dockerfile                 # Docker configuration
```

<br/>

## File Descriptions

### model.pkl
- File containing the saved RandomForestClassifier model
- Configured with n_estimators=100, random_state=42
- Saved using joblib.dump()
- Generated by running train_model.py in actual use

### scaler.pkl
- File containing the saved StandardScaler object
- Stores scaling parameters used in data preprocessing
- Saved using joblib.dump()
- Generated by running preprocess.py in actual use

<br/>

## Installation and Execution

<br/>

### 1. Local Environment Setup

1. Create and activate virtual environment:
```bash
python3 -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
```

2. Install dependencies:
```bash
pip3 install -r requirements.txt
```

3. Preprocess data:
```bash
python3 preprocess.py
```

4. Train model:
```bash
python3 train_model.py
```

5. Run API server:
```bash
python3 predict_api.py
```

### 2. Docker Setup

1. Build Docker image:
```bash
docker build -t mlops-demo .
```

2. Run Docker container:
```bash
docker run -p 8000:8000 mlops-demo
```

<br/>

## API Usage

1. Single prediction (CSV file):
```bash
curl -X POST "http://localhost:8000/predict" -H "accept: application/json" -H "Content-Type: multipart/form-data" -F "file=@data/test.csv"
```

2. Batch prediction (JSON):
```bash
curl -X POST "http://localhost:8000/predict_batch" -H "accept: application/json" -H "Content-Type: application/json" -d '[{"feature1": 1.0, "feature2": 2.0}]'
```

<br/>

## API Documentation

FastAPI auto-generated documentation is available at:
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc